Chabrin Lease Management System  -   Specification v 1 .0    Page  1   of  24       CHABRIN AGENCIES LTD       DIGITAL LEASE MANAGEMENT SYSTEM    Technical Specification & Implementation Guide       Version  1 .0  -   Complete Architecture    January 2026       Prepared  by : IT Department    Integration Target: CHIPS System       VERSION  1 .0  -   COMPLETE FEATURES    • Two Lease Sources: Chabrin - Generated + Landlord - Provided    • Two Signing Paths: Digital (Online with OTP) + Physical (FO Delivery)    • Lawyer Workflow: Email or Physical, Flexible Return Methods   • Full Edit Tracking with Document Versioning    • Financial Lock: Deposit Verification Before Activation   • Guarantor Support, Rent Escalation, Renewal Workflows    • Enforced Workflow State Transitions       

Chabrin Lease Management System  -   Specification v 1 .0    Page  2   of  24    Table of Contents       1. Executive Summary    2. Lease Sources & Types    3. Signing Modes: Digital vs Physical    4. Workflow: Chabrin Leases    5. Workflow: Landlord Leases    6. Workflow States & Enforced Transitions    7. Lawyer Workflow (Flexible)    8. Copy Distribution    9. Renewal & Expiry Workflow    10. User Roles & Permissions    11. Database Schema (Complete)    12. Security Features    13. Technology Stack    14. Implementation Phases       

Chabrin Lease Management System  -   Specification v 1 .0    Page  3   of  24    1. Executive Summary    This document specifies a complete Digital Lease Management System for Chabrin   Agencies Ltd, managing 1,500+ properties, 40,000+ tenants across 7 operational zones   (A - G). The system integrates with the existing CHIPS platform.       1.1 Core Capabilities    Capability   Description    Dual Lease Sources   Chabrin - generated leases from templates + Landlord - provided   leases with edit tracking    Dual Signing Paths   Digital signing (online via secure link with OTP) + Physical   signing (FO delivery)    Flexible Lawyer Flow   Send to lawyer via email or physical; receive back via email or   physical    Financial Integration   Deposit verification from CHIPS before lease activation    Complete Audit Trail   Every action logged with timestamp, user, IP address, and role   at time of action    Enforced Workflows   State transitions validated  -   prevents skipping steps or invalid   sequences    Renewal Automation   90 - day expiry alerts, renewal offer generation, seamless   transition       1.2 Key Design Principles    •   Process System, Not Just CRUD: Workflows are explicit and enforceable    •   Role - Based Security: Permissions reflect real operational risk    •   Legal Defensibility: Full audit trail, edit history, document versioning    •   Financial Safety: No lease activation without deposit verification    •   Flexibility: Accommodates both digital and physical processes                                

Chabrin Lease Management System  -   Specification v 1 .0    Page  4   of  24    2. Lease Sources & Types    2.1 Two Lease Sources    Source   Description   Key Characteristics    CHABRIN   Leases generated by Chabrin using   standard templates    System generates PDF; 3 template   types; no external editing needed    LANDLORD   Leases provided by property   landlords    Can be physical or digital; PM/APM   may edit; requires landlord   approval; full edit tracking       2.2 Chabrin Lease Types (3 Templates)    Lease Type   Pages   Use Case   Reference Code    Commercial   7   Shops, offices, businesses   LSE - COM - {ZONE} - {SEQ} - {YEAR}    Residential Micro   2   Bedsitters, single rooms   LSE - RMI - {ZONE} - {SEQ} - {YEAR}    Residential Major   5   Apartments, family units   LSE - RMA - {ZONE} - {SEQ} - {YEAR}    Landlord Provided   Varies   Any (landlord's own   template)    LSE - LAN - {ZONE} - {SEQ} - {YEAR}       2.3 Reference Number Generation (Race - Condition Safe)    To prevent duplicate reference numbers under concurrent access, the system uses a   sequence table:       lease_sequences Table:    zone   year   lease_type   last_sequence    A   2026   commercial   142    A   2026   residential_micro   1853    The system locks the row, increments, generates the reference, then releases. This   prevents duplicates.    3. Signing Modes: Digital vs Physical    The Zone Manager chooses the signing mode when creating or approving a lease. This   decision locks the workflow into one of two paths.     

Chabrin Lease Management System  -   Specification v 1 .0    Page  5   of  24    3.1 Signing Mode Selection    Mode   How It Works   When to Use    DIGITAL   System sends secure link to tenant   via email/SMS (based on tenant   preference). Tenant verifies via OTP,   reviews lease, signs online.    Tenant has smartphone/email   access; faster turnaround; no FO   travel needed    PHYSICAL   ZM/PM prints lease. FO checks out   document, delivers to tenant,   collects signature, returns to office.    Tenant prefers paper; remote   areas; complex leases needing   explanation       3.2 Digital Signing Flow    Step 1: Zone Manager creates lease and selects 'DIGITAL' signing mode    Step 2: System checks tenant's notification preference (Email, SMS, or Both)    Step 3: System generates secure one - time signing link    Step 4: Link sent to tenant via their preferred channel(s)    Step 5: Tenant clicks link → System sends OTP to tenant's phone    Step 6: Tenant enters OTP to verify identity    Step 7: Tenant reviews lease document online    Step 8: Tenant signs using finger/stylus on screen    Step 9: System captures signature, timestamps, and IP address    Step 10: Lease moves to TENANT_SIGNED state    Step 11: [If lawyer needed] PM sends to lawyer via email or physical    Step 12: Lawyer returns stamped document (email or physical)    Step 13: PM uploads final version if returned physically    Step 14: System verifies deposit paid in CHIPS    Step 15: Lease activated; copies sent via email to tenant and landlord       3.3 Physical Signing Flow    Step 1: Zone Manager creates lease and selects 'PHYSICAL' signing mode    Step 2: ZM or PM prints the lease (FO has NO print rights)    Step 3: FO checks out physical document (logged in system)    Step 4: FO delivers to tenant, explains terms if needed    Step 5: Tenant signs physical document  

Chabrin Lease Management System  -   Specification v 1 .0    Page  6   of  24    Step 6: FO returns signed document to office (logged in system)    Step 7: [If lawyer needed] Document sent to lawyer (physical or scanned email)    Step 8: Lawyer stamps and returns (physical or scanned email)    Step 9: PM/APM scans and uploads final signed document    Step 10: System verifies deposit paid in CHIPS    Step 11: Lease activated; physical copy given to tenant, email to landlord                3.4 Tenant Notification Preferences    Each tenant record includes their preferred contact method for lease signing:    Preference   System Behavior    EMAIL   Signing link sent to tenant's email address only    SMS   Signing link sent via SMS to tenant's phone only    BOTH   Signing link sent to BOTH email AND SMS for maximum reach    Note: OTP for verification is ALWAYS sent via SMS regardless of preference.    4. Workflow: Chabrin Leases    Chabrin leases are generated from templates. The workflow differs based on signing   mode.       4.1 Digital Path    DRAFT → APPROVED → SENT_DIGITAL → PENDING_OTP_VERIFICATION → TENANT_SIGNED   → [WITH_LAWYER] → PENDING_DEPOSIT → ACTIVE       4.2 Physical Path    DRAFT → APPROVED → PRINTED → CHECKED_OUT → PENDING_TENANT_SIGNATURE →   TENANT_SIGNED → [WITH_LAWYER] → PENDING_UPLOAD → PENDING_DEPOSIT → ACTIVE        

Chabrin Lease Management System  -   Specification v 1 .0    Page  7   of  24    4.3 Workflow Diagram  -   Digital    ┌──────────────────────────────────────────────────────────  ───────┐    │  ZM Creates Lease (selects DIGITAL mode)                        │    │                          ↓                                      │    │  System Generates PDF from Template                             │    │                          ↓                                      │    │  ZM Approves → Status: APPROVED                                 │    │                          ↓                                      │    │  System Sends Link (Email/SMS per tenant preference)            │    │                          ↓                                      │    │  Status: SENT_DIGITAL                                           │    │                          ↓                                      │    │  Tenant Clicks Link → OTP Sent → Status: PENDING_OTP            │    │                          ↓                                      │    │  Tenant Enters OTP → Verified → Reviews Lease                   │    │                          ↓                                      │    │  Tenant Signs Online → Status: TENANT_SIGNED                    │    │                          ↓                                      │    │  [If Lawyer Required] → Send to Lawyer → Status: WITH_LAWYER    │    │                          ↓                                      │    │  Lawyer Returns (Email or Physical) → Upload if Physical        │    │                          ↓                                      │    │  System Checks CHIPS: Deposit Paid? → Status: PENDING_DEPOSIT   │    │                          ↓                                      │    │  Deposit Confirmed → Status: ACTIVE                             │    │                          ↓                                      │    │  Send Copies: Tenant (Email) + Landlord (Email)                 │    └──────────────────────────────────────────────────────────  ───────┘           

Chabrin Lease Management System  -   Specification v 1 .0    Page  8   of  24    4.4 Workflow Diagram  -   Physical    ┌──────────────────────────────────────────────────────────  ───────┐    │  ZM Creates Lease (selects PHYSICAL mode)                       │    │                          ↓                                      │    │  System Generates PDF from Template                             │    │                          ↓                                      │    │  ZM Approves → Status: APPROVED                                 │    │                          ↓                                      │    │  ZM/PM Prints Lease → Status: PRINTED                           │    │                          ↓                                      │    │  FO Checks Out → Status: CHECKED_OUT                            │    │                          ↓                                      │    │  FO Delivers to Tenant → Status: PENDING_TENANT_SIGNATURE       │    │                          ↓                                      │    │  Tenant Signs → FO Returns → Status: TENANT_SIGNED              │    │                          ↓                                      │    │  [If Lawyer Required] → Send to Lawyer → Status: WITH_LAWYER    │    │                          ↓                                      │    │  Lawyer Returns → PM/APM Scans & Uploads → Status: PENDING_UPLOAD│    │                          ↓                                      │    │  System Checks CHIPS: Deposit Paid? → Status: PENDING_DEPOSIT   │    │                          ↓                                      │    │  Deposit Confirmed → Status: ACTIVE                             │    │                          ↓                                      │    │  Distribute: Tenant (Physical) + Landlord (Email)               │    └──────────────────────────────────────────────────────────  ───────┘       

Chabrin Lease Management System  -   Specification v 1 .0    Page  9   of  24    5. Workflow: Landlord Leases    Landlord leases follow a more complex flow because they may require editing and   landlord approval before tenant signing.       5.1 Complete Flow    RECEIVED → [EDITING] → PENDING_LANDLORD_APPROVAL → APPROVED → [DIGITAL or   PHYSICAL path] → TENANT_SIGNED → [WITH_LAWYER] → [PENDING_UPLOAD] →   PENDING_DEPOSIT → ACTIVE       5.2 Workflow Diagram    ┌──────────────────────────────────────────────────────────  ───────┐    │  Landlord Submits Lease (Physical or Digital File)              │    │                          ↓                                      │    │  Office Receives → Status: RECEIVED                             │    │                          ↓                                      │    │  PM/APM Reviews Document                                        │    │                          ↓                                      │    │  [If Edits Needed] PM/APM Edits (ALL CHANGES TRACKED)           │    │   -   Each edit logged with: who, what, when, why                  │    │   -   Document version incremented                                 │    │   -   Original preserved                                           │    │                          ↓                                      │    │  Status: PENDING_LANDLORD_APPROVAL                              │    │                          ↓                                      │    │  Landlord Approves (Email / Verbal / SMS / Via Lawyer)          │    │   -   Approval method and evidence recorded                        │    │                          ↓                                      │    │  Status: APPROVED                                               │    │                          ↓                                      │    │  ZM Selects Signing Mode: DIGITAL or PHYSICAL                   │    │                          ↓                                      │  

Chabrin Lease Management System  -   Specification v 1 .0    Page  10   of  24    │  [Follow Digital or Physical path from Section 4]               │    │                          ↓                                      │    │  Status: ACTIVE                                                 │    │                          ↓                                      │    │  Distribute Copies:                                             │    │   -   Landlord: Email or Physical                                  │    │   -   Tenant: Email or Physical                                    │    │   -   Office: Digital (stored in system)                           │    └──────────────────────────────────────────────────────────  ───────┘       5.3 Edit Tracking (Document Versioning)    Every edit to a landlord lease creates an audit record:    Field Tracked   Description    edited_by   Which PM or APM made the edit    edit_type   clause_added, clause_removed, clause_modified, other    section_affected   Which clause/section (e.g., 'Clause 7.3  -   Subletting')    original_text   What it said before (NULL if new clause)    new_text   What it says now (NULL if removed)    reason   Why the change was made    document_version   Version number (increments with each edit batch)    edited_at   Exact timestamp    This enables: 'Landlord approved Version 3 on 15 Jan 2026 via email.'       5.4 Landlord Approval Methods    Method   How It Works   Evidence Stored    EMAIL   Landlord replies to email confirming   approval    Email reference, date, sender    VERBAL   Landlord approves in person or phone   call    Staff who received approval,   date, notes    SMS   Landlord sends SMS confirmation   SMS content screenshot/text,   date  

Chabrin Lease Management System  -   Specification v 1 .0    Page  11   of  24    VIA_LAWYER   Landlord's lawyer communicates   approval    Lawyer name, firm, date,   communication ref       

Chabrin Lease Management System  -   Specification v 1 .0    Page  12   of  24    6. Workflow States & Enforced Transitions    The system enforces valid state transitions. Any attempt to make an invalid transition is   rejected.       6.1 All Workflow States    State   Owner   Description    DRAFT   ZM / PM   Lease created, not yet approved    RECEIVED   PM / APM   Landlord lease received (Landlord   leases only)    PENDING_LANDLORD_APPROVAL   Landlord   Edits made, awaiting landlord OK    APPROVED   ZM / PM   Ready for signing mode selection    PRINTED   ZM / PM   Physical copy printed (Physical path   only)    CHECKED_OUT   Field Officer   FO has physical lease for delivery    SENT_DIGITAL   Tenant   Signing link sent to tenant (Digital path   only)    PENDING_OTP   Tenant   Tenant clicked link, OTP sent, awaiting   verification    PENDING_TENANT_SIGNATURE   Tenant   With tenant for signing (Physical path)    RETURNED_UNSIGNED   ZM   Tenant refused or unavailable    TENANT_SIGNED   Office   Signed by tenant    WITH_LAWYER   Lawyer   At lawyer for stamping    PENDING_UPLOAD   PM / APM   Needs final document upload   (Physical/Lawyer return)    PENDING_DEPOSIT   System   Awaiting deposit verification from CHIPS    ACTIVE   System   Fully executed, tenancy in effect    RENEWAL_OFFERED   Tenant   Renewal offer sent (90 days before   expiry)    EXPIRED   System   Term ended    TERMINATED   ZM   Tenancy ended early    ARCHIVED   System   Historical record, read - only    CANCELLED   ZM / PM   Lease cancelled before activation       

Chabrin Lease Management System  -   Specification v 1 .0    Page  13   of  24    6.2 Enforced State Transitions    The system only allows these transitions. All others are rejected:       From State   Allowed Transitions To    DRAFT   APPROVED, CANCELLED    RECEIVED   PENDING_LANDLORD_APPROVAL, APPROVED,   CANCELLED    PENDING_LANDLORD_APPROVAL   APPROVED, CANCELLED    APPROVED   PRINTED, SENT_DIGITAL, CANCELLED    PRINTED   CHECKED_OUT, CANCELLED    CHECKED_OUT   PENDING_TENANT_SIGNATURE, RETURNED_UNSIGNED    SENT_DIGITAL   PENDING_OTP, CANCELLED    PENDING_OTP   TENANT_SIGNED, SENT_DIGITAL (resend)    PENDING_TENANT_SIGNATURE   TENANT_SIGNED, RETURNED_UNSIGNED    RETURNED_UNSIGNED   CHECKED_OUT (retry), CANCELLED    TENANT_SIGNED   WITH_LAWYER, PENDING_UPLOAD, PENDING_DEPOSIT    WITH_LAWYER   PENDING_UPLOAD, PENDING_DEPOSIT    PENDING_UPLOAD   PENDING_DEPOSIT    PENDING_DEPOSIT   ACTIVE (only when deposit verified)    ACTIVE   RENEWAL_OFFERED, EXPIRED, TERMINATED    RENEWAL_OFFERED   ACTIVE (renewed), EXPIRED    EXPIRED   ARCHIVED    TERMINATED   ARCHIVED    CANCELLED   ARCHIVED    Any attempt to transition outside this map results in an error and audit log entry.       

Chabrin Lease Management System  -   Specification v 1 .0    Page  14   of  24    7. Lawyer Workflow (Flexible)    The lawyer workflow is intentionally flexible because Chabrin does not control how   lawyers operate.       7.1 Sending to Lawyer    Send Method   How It Works    EMAIL   PM/ZM emails the signed PDF to lawyer. System records: lawyer name,   email, date sent.    PHYSICAL   Physical document handed to lawyer or courier. System records:   lawyer name, date sent, who handed over.       7.2 Receiving from Lawyer    Return Method   How It Works    EMAIL   Lawyer emails stamped PDF. PM downloads and uploads to system. No   additional scanning needed.    PHYSICAL   Lawyer returns physical stamped document. PM/APM scans and   uploads to system.       7.3 Lawyer Tracking Fields    •   lawyer_id: Which lawyer is handling (from lawyers table)    •   sent_to_lawyer_method: 'email' or 'physical'    •   sent_to_lawyer_at: Timestamp    •   sent_to_lawyer_by: User who sent    •   returned_from_lawyer_method: 'email' or 'physical'    •   returned_from_lawyer_at: Timestamp    •   received_from_lawyer_by: User who received    •   lawyer_turnaround_days: Calculated (return date  -   send date)       

Chabrin Lease Management System  -   Specification v 1 .0    Page  15   of  24    8. Copy Distribution    After a lease becomes ACTIVE, copies must be distributed to all parties.       8.1 Distribution Requirements    Recipient   Chabrin Lease   Landlord Lease   Method Options    Tenant   Required   Required   Email OR Physical    Landlord   Not needed   Required   Email OR Physical    Office   Digital (in system)   Digital (in system)   Automatic       8.2 Distribution Tracking    System tracks when and how each copy was distributed:    •   tenant_copy_method: 'email' or 'physical'    •   tenant_copy_sent_at: Timestamp (email) or given date (physical)    •   tenant_copy_sent_by: User who sent/gave    •   landlord_copy_method: 'email' or 'physical'    •   landlord_copy_sent_at: Timestamp    •   landlord_copy_sent_by: User who sent/gave       Note: Tenants do NOT have direct system access. They receive copies via email or   physical handover.    9. Renewal & Expiry Workflow    The system proactively manages lease renewals rather than waiting for manual   intervention.       9.1 Automatic Alerts    Trigger   System Action    90 days before expiry   Alert sent to Zone Manager: 'Lease LSE - xxx - xxx expiring in 90 days.   Initiate renewal?'    60 days before expiry   Second alert if no action taken. Escalate to PM if still no action.    30 days before expiry   Urgent alert. Lease status changes to RENEWAL_OFFERED if offer   sent, otherwise flagged.    Expiry date reached   Lease status changes to EXPIRED. Alert sent to ZM and PM.  

Chabrin Lease Management System  -   Specification v 1 .0    Page  16   of  24          9.2 Renewal Process    Step 1: ZM receives 90 - day alert    Step 2: ZM creates Renewal Offer with new terms (rent, duration)    Step 3: System generates renewal lease, copying data from original    Step 4: Renewal sent to tenant (Email/SMS based on preference)    Step 5: Lease status: RENEWAL_OFFERED    Step 6: Tenant accepts → New lease created, old lease archived    Step 7: Tenant rejects or no response → Old lease expires on end date       9.3 Rent Escalation (Automatic Increases)    Commercial leases often include automatic rent increases. The system tracks these:       lease_escalations Table:    lease_id   effective_date   new_rent   increase_%   applied    42   2027 - 01 - 01   55,000   10%   No    42   2028 - 01 - 01   60,500   10%   No    System alerts PM 30 days before each escalation date. When date arrives, rent updates   automatically in CHIPS.    10. User Roles & Permissions       10.1 Role Hierarchy    Super User (Top Management)         ↓    System Administrator         ↓    Property Manager / Assistant Property Manager         ↓    Zone Managers (AB, C, D, E, F, G)  

Chabrin Lease Management System  -   Specification v 1 .0    Page  17   of  24         ↓    Senior Field Officers         ↓    Field Officers       Audit Department (Parallel  -   Read Only)       10.2 Permissions Matrix    Role   Permissions    Super User   Full access. View all zones. Override any action. Access all audit   logs. Manage users. Configure system.    System Admin   Manage users and roles. Configure settings. View audit logs.   Cannot modify leases.    Property Manager   View all zones. Edit landlord leases. Upload final documents. Print   leases. Generate reports. Approve templates. Send to lawyers.    Asst. Property Mgr   Same as PM. Acts as backup/delegate.    Zone Manager   Create Chabrin leases (own zone). Approve leases. Select signing   mode. Print leases. Assign FOs. Send to lawyers. CANNOT edit   landlord leases. CANNOT upload final scans.    Senior Field Officer   Check out leases. Return leases. View zone leases. Supervise FOs.   Cannot create/edit/print.    Field Officer   Check out assigned leases. Return leases. View own assignments.   NO print. NO edit.    Audit   Read - only access to ALL leases, ALL audit logs, ALL zones.   Generate compliance reports. Cannot modify anything.       10.3 Critical Restrictions    Action   Restricted To    Edit landlord leases   PM, APM only    Upload final signed documents   PM, APM only    Print leases   PM, APM, ZM only (NOT Field Officers)    Send to lawyer   PM, APM, ZM    Select signing mode   ZM (at lease creation)    View audit logs   Super User, System Admin, Audit  

Chabrin Lease Management System  -   Specification v 1 .0    Page  18   of  24    11. Database Schema (Complete)    All tables use VARCHAR with CHECK constraints instead of ENUMs for flexibility.       11.1 leases (Main Table)    Column   Type   Description    id   SERIAL PK   Auto - incrementing primary key    reference_number   VARCHAR(30)   Unique (LSE - COM - A - 00142 - 2026)    source   VARCHAR(20)   'chabrin' or 'landlord'    lease_type   VARCHAR(30)   'commercial', 'residential_micro',   'residential_major', 'landlord_provided'    signing_mode   VARCHAR(20)   'digital' or 'physical'    workflow_state   VARCHAR(40)   Current state (see Section 6)    tenant_id   INT FK   References tenants table    unit_id   INT FK   References units table    property_id   INT FK   References properties table    landlord_id   INT FK   References landlords (for landlord leases)    zone   CHAR(1)   Zone letter (A - G)    monthly_rent   DECIMAL(12,2)   Rent in KES    deposit_amount   DECIMAL(12,2)   Required deposit in KES    deposit_verified   BOOLEAN   TRUE when CHIPS confirms payment    deposit_verified_at   TIMESTAMP   When deposit was verified    start_date   DATE   Tenancy start    end_date   DATE   Tenancy end (NULL if periodic)    lease_term_months   INT   Duration in months    is_periodic   BOOLEAN   TRUE for month - to - month    requires_lawyer   BOOLEAN   Whether lawyer stamp needed    requires_guarantor   BOOLEAN   Whether guarantor required    document_version   INT   Current version (increments on edits)    original_document_path   VARCHAR(500)   Original landlord doc (before edits)    generated_pdf_path   VARCHAR(500)   System - generated or edited PDF    signed_pdf_path   VARCHAR(500)   Final signed document  

Chabrin Lease Management System  -   Specification v 1 .0    Page  19   of  24    signed_pdf_hash   VARCHAR(64)   SHA - 256 hash for integrity    created_by   INT FK   User who created    created_at   TIMESTAMP   Creation time    updated_at   TIMESTAMP   Last update       11.2 lease_edits (Edit Tracking)    Column   Type   Description    id   SERIAL PK   Auto - incrementing primary key    lease_id   INT FK   References leases    edited_by   INT FK   PM or APM who made edit    edit_type   VARCHAR(30)   'clause_added', 'clause_removed',   'clause_modified', 'other'    section_affected   VARCHAR(200)   Which clause (e.g., 'Clause 7.3')    original_text   TEXT   Before (NULL if new)    new_text   TEXT   After (NULL if removed)    reason   TEXT   Why changed    document_version   INT   Version this edit belongs to    edited_at   TIMESTAMP   Exact time of edit       11.3 guarantors    Column   Type   Description    id   SERIAL PK   Auto - incrementing primary key    lease_id   INT FK   References leases    name   VARCHAR(200)   Guarantor full name    id_number   VARCHAR(20)   National ID    phone   VARCHAR(20)   Phone number    email   VARCHAR(100)   Email address    relationship   VARCHAR(50)   Relationship to tenant    signed   BOOLEAN   Has guarantor signed    signed_at   TIMESTAMP   When signed     

Chabrin Lease Management System  -   Specification v 1 .0    Page  20   of  24          11.4 lease_escalations (Rent Increases)    Column   Type   Description    id   SERIAL PK   Auto - incrementing primary key    lease_id   INT FK   References leases    effective_date   DATE   When increase takes effect    previous_rent   DECIMAL(12,2)   Rent before increase    new_rent   DECIMAL(12,2)   Rent after increase    increase_percentage   DECIMAL(5,2)   Percentage increase    applied   BOOLEAN   Has this been applied to CHIPS    applied_at   TIMESTAMP   When applied       11.5 Additional Tables (Summary)    Table   Purpose    lease_sequences   Race - condition safe reference number generation (zone, year,   type, last_sequence)    landlord_approvals   Records landlord approval of edits (method, evidence, date)    lawyers   Lawyer directory (name, firm, phone, email, specialization)    lease_lawyer_tracking   Tracks sending/receiving from lawyer (method, dates, who)    lease_handovers   Physical document movement (checkout, return, who, when)    lease_copy_distribution   Tracks copies given to tenant/landlord (method, date, who)    lease_digital_signatures   Digital signature data (signature image, IP, timestamp, OTP   verified)    lease_otp_verifications   OTP attempts and verification (code, sent_at, verified_at,   attempts)    lease_audit_log   Complete audit trail (action, old_state, new_state, user,   user_role_at_time, IP, timestamp)    lease_print_log   Every print event (user, workstation, timestamp)  

Chabrin Lease Management System  -   Specification v 1 .0    Page  21   of  24    12. Security Features       12.1 OTP Verification (Digital Signing)    •   When tenant clicks signing link, system sends 4 - digit OTP to their phone    •   OTP valid for 10 minutes    •   Maximum 3 attempts; after that, new OTP must be requested    •   All attempts logged (for fraud detection)    •   Tenant cannot view or sign lease without valid OTP entry       12.2 Document Integrity    •   SHA - 256 hash computed for every uploaded PDF    •   Hash stored in database alongside file path    •   System can detect if file has been tampered with    •   Audit department can verify document integrity at any time       12.3 Print Logging    •   Every print event logged: who, when, which lease, workstation    •   Enables tracking of unauthorized printing    •   Field Officers cannot print (enforced at role level)       12.4 Audit Log Completeness    •   Every action logged with timestamp    •   User's role AT TIME OF ACTION recorded (roles change over time)    •   IP address captured    •   Old state and new state recorded for every transition    •   Logs are append - only (cannot be modified or deleted)       12.5 Session Security    •   Sessions timeout after 30 minutes of inactivity    •   Concurrent session limit per user    •   Session invalidated on password change  

Chabrin Lease Management System  -   Specification v 1 .0    Page  22   of  24    13. Technology Stack       Component   Technology   Notes    Backend   PHP 8.2 + Laravel 11   Matches CHIPS. Excellent documentation.    Database   PostgreSQL 15+   Already in use. Robust.    File Storage   DigitalOcean Spaces   S3 - compatible.     PDF Generation   DomPDF   PHP native.    PDF Compression   Ghostscript   60 - 80% reduction.    QR Codes   Simple QRcode   Laravel package.    Digital Signatures   Canvas + PHP   Custom.     OTP   Africa's Talking   Already in use.    Email   Dreamhost SMTP   Already in use.    Mobile   Flutter + REST API   Existing FO app.    Hashing   SHA - 256 (PHP native)   Document integrity.  

Chabrin Lease Management System  -   Specification v 1 .0    Page  23   of  24    14. Implementation Phases       Phase 1: Foundation     Goal: Basic lease creation and PDF generation    •   Laravel project setup    •   Database migrations (all tables)    •   HTML templates for 3 Chabrin lease types    •   PDF generation with DomPDF    •   Reference number generation (race - condition safe)    •   DigitalOcean Spaces integration    •   Basic CRUD operations    Deliverable: ZM can create lease, generate PDF, view it.       Phase 2: Workflows & Roles     Goal: Complete workflow with enforced transitions    •   Implement all workflow states    •   Enforce valid state transitions    •   Role - based access control (8 roles)    •   Handover tracking (FO checkout/return)    •   Audit logging (including role at time of action)    •   Print logging    •   Search and filtering    •   Role - specific dashboards    Deliverable: Full workflow with proper permissions.       Phase 3: Digital Signing & Landlord Leases    Goal: Both signing paths and landlord workflow    •   Digital signature capture (canvas)    •   OTP verification system    •   Tenant signing portal (secure link)    •   Landlord lease upload and editing    •   Edit tracking with document versioning    •   Landlord approval recording    •   Scanned PDF upload with compression    •   Document integrity hashing    •   Email delivery (Dreamhost)    •   SMS delivery (Africa's Talking)    Deliverable: Both digital and physical paths working.     

Chabrin Lease Management System  -   Specification v 1 .0    Page  24   of  24       Phase 4: Integration & Advanced    Goal: Full integration and automation    •   CHIPS integration for deposit verification    •   Lawyer workflow (send/receive tracking)    •   Copy distribution tracking    •   Guarantor management    •   Rent escalation tracking    •   Renewal workflow (90 - day alerts)    •   REST API for Flutter app    •   FO mobile app integration    •   Reporting module    •   Pilot with one zone → Roll out    Deliverable: Complete system in production.                                                             —   End of Specification Document  —    Version  1 .0  -   Complete Architecture    Digital + Physical Signing | Chabrin + Landlord Leases | Full Audit Trail  